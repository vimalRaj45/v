<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign in with Outlook</title>
</head>
<body>
    <h1>v</h1>
    <h2>Sign in with Outlook</h2>

    <a id="loginBtn" href="#" class="btn">Login with Microsoft</a>

    <script>
        // Check if the user is already signed in
        function checkSSO() {
            const token = sessionStorage.getItem("id_token");
            if (token) {
                window.location.href = "https://vimalraj45.github.io/v/after"; // Redirect if already signed in
            }
        }

        // Configure the login URL
        const clientId = "3689c71b-e171-42dc-b794-f25937355139"; // Replace with your app's client ID
        const redirectUri = "https://vimalraj45.github.io/v/after"; // Replace with your redirect URI
        const scopes = "openid profile email User.Read"; // Scopes for ID token and user info

        const loginUrl = 
            "https://login.microsoftonline.com/common/oauth2/v2.0/authorize" +
            "?client_id=" + encodeURIComponent(clientId) +
            "&response_type=id_token" + // Request an ID token for SSO
            "&redirect_uri=" + encodeURIComponent(redirectUri) +
            "&scope=" + encodeURIComponent(scopes) +
            "&response_mode=fragment" + // Recommended for SPAs
            "&prompt=none"; // Enable silent SSO

        document.getElementById("loginBtn").href = loginUrl;

        // Check for SSO on page load
        checkSSO();
    </script>

    <style>
      .btn {
        display: inline-block;
        background-color: #0078D4;
        color: white;
        padding: 10px 20px;
        font-size: 16px;
        text-decoration: none;
        border-radius: 5px;
        font-weight: bold;
      }
      .btn:hover {
        background-color: #005A9E;
      }
    </style>
</body>
</html>
